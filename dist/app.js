!function(t){function e(r){if(i[r])return i[r].exports;var s=i[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){i(1),t.exports=i(2)},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();(new(function(){function t(){r(this,t),this.key="40c8d4e755a53b1d45a970fc3769eeeb",this.count="&cnt=8",this.apiURL="https://api.openweathermap.org/data/2.5/",this.units=function(){return localStorage.units?localStorage.units:"metric"}(),this.city=null,this.response=null,this.responseForecast=null,this.searchForm=document.querySelector("#search-form"),this.searchList=document.querySelector("#search-list"),this.favouriteList=document.querySelector("#favourite-list"),this.forecastWrapper=document.querySelector(".forecast-wrapper"),this.clearHistoryButton=document.querySelector("#clear-history"),this.clearFavouritesButton=document.querySelector("#clear-favourites"),this.addFavouriteCityButton=document.querySelector("#add-button"),this.swapUnitsButton=document.querySelector("#swap-units-button"),this.searchHistory=[],this.favouriteCities=[]}return s(t,[{key:"getCityFromUrl",value:function(){var t=new URL(window.location.href);t.search.startsWith("?q=")&&(this.city=t.search.slice(3))}},{key:"addCityToSearchHistory",value:function(t){var e=this.searchHistory,i=e.indexOf(t);i>=0&&e.splice(i,1),e.includes(t)||(e.push(t),localStorage.searchHistory=JSON.stringify(e))}},{key:"getSearchHistory",value:function(){localStorage.searchHistory&&(this.searchHistory=JSON.parse(localStorage.searchHistory))}},{key:"addCityToFavouriteCities",value:function(t){var e=this.favouriteCities;if(!e.includes(t)){if(4===e.length)return void alert("Too many cities");e.push(t),localStorage.favouriteCities=JSON.stringify(e)}}},{key:"getFavouriteCities",value:function(){localStorage.favouriteCities&&(this.favouriteCities=JSON.parse(localStorage.favouriteCities))}},{key:"addFormSubmitHandler",value:function(t,e){var i=this;t.onsubmit=function(){return i.city=t.elements.cityName.value,e.call(i),!1}}},{key:"init",value:function(){var t=this;this.getCityFromUrl(),this.city&&this.getWeather(),this.getSearchHistory(),this.getFavouriteCities(),this.addFormSubmitHandler(this.searchForm,this.getWeather),this.populateSearchList(),this.populateFavouriteList(),this.clearHistoryButton.onclick=function(){t.clearHistory()},this.clearFavouritesButton.onclick=function(){t.clearFavourites()},this.addFavouriteCityButton.onclick=function(){t.addCityToFavouriteCities(t.city),t.populateFavouriteList()},this.swapUnitsButton.onclick=function(){t.swapUnits(),t.getWeather(),t.getForecast()},this.forecastWrapper.querySelector(".current-weather-wrapper").onclick=function(){self.responseForecast||t.getForecast(),t.forecastWrapper.querySelector(".forecast-list").classList.toggle("show-forecast")}}},{key:"updateUrl",value:function(){window.history.pushState(null,null,"?q="+this.city)}},{key:"addCityTitle",value:function(){var t="Weather App - "+this.city;document.title!==t&&(document.title=t)}},{key:"getWeather",value:function(){var t=this,e=new XMLHttpRequest;e.open("GET",this.apiURL+"weather?q="+this.city+"&APPID="+this.key+"&units="+this.units+this.count),e.onreadystatechange=function(){if(4==this.readyState){if(200!=this.status)return void alert("error: "+(this.status?this.statusText:"request failed"));var e=this.responseText;t.response=JSON.parse(e),t.city=t.response.name,t.addCityToSearchHistory(t.city),t.updateUrl(),t.addCityTitle(),t.populateSearchList(),t.drawWeather(t.response),t.toggleUnits()}},e.send(),console.log(this)}},{key:"getForecast",value:function(){var t=this,e=new XMLHttpRequest;e.open("GET",this.apiURL+"forecast?q="+this.city+"&APPID="+this.key+"&units="+this.units+this.count),e.onreadystatechange=function(){if(4==this.readyState){if(200!=this.status)return void alert("error: "+(this.status?this.statusText:"request failed"));var e=this.responseText;t.responseForecast=JSON.parse(e),t.drawForecast(t.responseForecast)}},e.send(),console.log(this)}},{key:"populateSearchList",value:function(){this.searchList.innerHTML="";for(var t=this.searchHistory.length-1;t>=0;t--){var e=this.searchHistory[t],i=document.createElement("li");i.innerHTML='<a href="?q='+e+'">'+e+"</a>",this.searchList.appendChild(i)}}},{key:"populateFavouriteList",value:function(){if(0!==this.favouriteCities.length){this.favouriteList.innerHTML="";for(var t=this.favouriteCities.length-1;t>=0;t--){var e=this.favouriteCities[t],i=document.createElement("a");i.innerHTML=""+e,i.href="?q="+e,this.favouriteList.appendChild(i)}}}},{key:"drawWeathericons",value:function(t,e){for(var i=t.length-1;i>=0;i--){var r="";t[i].icon.endsWith("n")&&(r="-night"),t[i].icon.endsWith("d")&&(r="-day");var s=document.createElement("i");s.className="wi wi-owm"+r+"-"+t[i].id,s.title=t[i].main+": "+t[i].description,e.appendChild(s)}}},{key:"drawWeather",value:function(t){this.forecastWrapper.querySelector(".current-weather-city").innerHTML=""+t.name,this.forecastWrapper.querySelector(".current-weather-temp").innerHTML=t.main.temp.toFixed(0)+"&deg;",this.forecastWrapper.querySelector(".current-weather-icon").innerHTML="";var e=this;this.drawWeathericons(t.weather,e.forecastWrapper.querySelector(".current-weather-icon"))}},{key:"drawForecast",value:function(t){var e=this.forecastWrapper.querySelector(".forecast-list");e.innerHTML="";for(var i=0;i<t.list.length;i++){var r=new Date(1e3*t.list[i].dt),s=r.getHours();s<10&&(s="0"+s);var a=document.createElement("div");a.className="forecast-list-three-hour",a.innerHTML='\n\t\t\t\t<div class="time">'+s+'</div>\n\t\t\t\t<div class="icon"></div>\n\t\t\t\t<div class="temp">'+t.list[i].main.temp.toFixed(0)+"</div>\n\t\t\t",this.drawWeathericons(t.list[i].weather,a.querySelector(".icon")),e.appendChild(a)}}},{key:"clearHistory",value:function(){this.searchHistory.length=0,this.searchList.innerHTML="",localStorage.searchHistory="[]"}},{key:"clearFavourites",value:function(){this.favouriteCities.length=0,this.favouriteList.innerHTML="<span>click + to add the city to your favorites</span>",localStorage.favouriteCities="[]"}},{key:"swapUnits",value:function(){"metric"===this.units?this.units="imperial":this.units="metric",localStorage.units=this.units}},{key:"toggleUnits",value:function(){"metric"===this.units?this.swapUnitsButton.innerHTML="&deg;C":this.swapUnitsButton.innerHTML="&deg;F"}}]),t}())).init()},function(t,e){}]);